import './interfaces/ICartoons.sol';
import './interfaces/IERC721.sol';

pragma solidity ^0.8.6;

/*
    Test Contract to try and exploit our Cartoons public mint
    used in /test/sim.js

    Not intended to be deployed/for production use
*/

contract ExploitSim {
    address victim;
    bool reenter;
    constructor(address _victim){
        victim = _victim;
    }

    function multicallExploit() public payable {
        ICartoons(victim).publicMint{ value: 70000000000000000 }(1);
        ICartoons(victim).publicMint{ value: 70000000000000000 }(1);
    }

    function reentrancyExploit() public payable {
        reenter = true;
        ICartoons(victim).publicMint{ value: 70000000000000000 }(1);
    }

    function onERC721Received(
        address operator,
        address from,
        uint256 tokenId,
        bytes calldata data
    ) external returns (bytes4){
        if(reenter){
            reenter = false;
            ICartoons(victim).publicMint{ value: 70000000000000000 }(1);
        }
        return 0x150b7a02;
    }
    
}   